<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Diferença de dia entre datas</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>
        // Path para a requisição (URL)
        const PATH = "http://localhost:8080/ds?di=";

        function atualizaDiaDaSemana() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    let dds = extraiDiaDaSemanaDaResposta(xhttp.responseText);
                    document.getElementById("resultado").innerHTML = `${dds} é a diferença em dias entre as duas datas.`;
                }
            };

            let dataAnoMesDia = document.getElementById("data").value;
            let data = formataData(dataAnoMesDia);
            let dataAnoMesDia2 = document.getElementById("dataFinal").value;
            let dataFinal = formataData(dataAnoMesDia2);
            xhttp.open("GET", PATH + data + '&df=' + dataFinal , true);
            xhttp.send();
        }

        function dataCorrente() {
            document.getElementById("data").valueAsDate = new Date();
            document.getElementById("dataFinal").valueAsDate = new Date();
        }

        // Funções para integração (satisfazer contrato do servidor)

        function extraiDiaDaSemanaDaResposta(resposta) {
            return resposta;
        }

        // Dia ou mês deve possuir dois dígitos
        function formataDiaOuMes(n) {
            return ("00" + n).substr(-2, 2);
        }

        // Ano deve possuir quatro dígitos
        function formataAno(n) {
            return ("0000" + n).substr(-4,4);
        }

        // ENTRADA: ano-mes-dia SAIDA: dd-mm-yyyy
        function formataData(data) {
            let [a, m, d] = data.split("-");

            let dia = formataDiaOuMes(d);
            let mes = formataDiaOuMes(m);
            let ano = formataAno(a);

            return `${d}-${m}-${a}`;
        }
    </script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</head>
<body onload="dataCorrente()">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 mt-5">
                <div class="mb-3">
                    <h1>Diferença de dias entre duas datas.</h1>
                </div>
                <div class="row">
                    <div class="col-lg-6">
                        <div class="form-group">
                            <label for="data">Insira a data inicial (Mês/Dia/Ano)</label><br>
                            <input class="form-control" type="date" id="data" onchange="atualizaDiaDaSemana()">
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="form-group">
                            <label for="dataFinal">Insira a data final (Mês/Dia/Ano)</label><br>
                            <input class="form-control" type="date" id="dataFinal" onchange="atualizaDiaDaSemana()">
                        </div>
                    </div>
                </div>
                <div class="text-center pt-3">
                    <button class="btn btn-primary" onclick="atualizaDiaDaSemana();">Obtenha diferença de dias</button><br>
                </div>
                <div class="text-center mt-5">
                    <span style="color: rgb(17, 20, 32); font-size: 20pt;" id="resultado"></span>
                </div>
            </div>
        </div>
    </div>
</body>
</html>